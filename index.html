<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>IGCSE Past Paper Finder</title>
<style>
/* Reset and body */
* { box-sizing: border-box; }
html, body { margin: 0; padding: 0; font-family: Arial, sans-serif; background-color: #222; color: white; }
body { display: flex; flex-direction: column; min-height: 100vh; }
/* Headings */
h2 { text-align: center; margin: 2vh 0; font-size: 4vh; }
/* Wrapper */
.wrapper { flex: 1; display:flex; flex-direction:column; justify-content:center; align-items:center; width:100%; }
/* Form container */
.form-container { display:flex; flex-direction:column; gap:2vh; width:95%; max-width:600px; margin:0 auto; }
/* Field */
.field { display:flex; flex-direction:column; align-items:flex-start; width:100%; }
label { font-weight:bold; margin-bottom:0.5vh; font-size:3vh; }
/* Inputs */
input {
  width:100%;
  height:6vh;
  font-size:2.5vh;
  padding:0.5vh 10px;
  border-radius:8px;
  border:1px solid white;
  background-color:black;
  color:white;
}
input:focus { outline:none; }
/* Error message */
#error { color:#ff6b6b; font-weight:bold; text-align:center; margin-top:1vh; font-size:2.2vh; min-height:2.2em; }
/* Field row */
.field-row { display:flex; width:100%; gap:2vw; margin:0; }
.field-row .field { flex:1; }
/* Button groups */
.button-group { display:flex; flex-wrap:wrap; gap:1vh; width:100%; }
.button-group button {
  flex:1; min-width:30%; padding:1.2vh 0;
  font-size:clamp(2.2vh,2vw,2.5vh);
  border-radius:8px; border:1px solid white; background-color:black; color:white;
  cursor:pointer; text-align:center; transition:all .2s;
}
.button-group button.selected { border:3px solid white; }
.button-group button:hover { background-color:#444; }
/* Main buttons */
.buttons {
  display:grid;
  grid-template-columns: 1fr 1fr;
  grid-template-rows: auto auto;
  gap:2vh;
  width:100%;
  max-width:600px;
  margin:2vh auto 0 auto;
}
button.main {
  width:100%; height:7.5vh;
  font-size:clamp(2.2vh,2vw,2.4vh);
  border-radius:8px; border:1px solid white; background-color:black; color:white; cursor:pointer;
}
button.main:hover { background-color:#444; }
/* QP + MS container - TN will span both columns */
#qpMsContainer { display:flex; width:100%; gap:1vw; grid-column: span 2; }
/* Mobile styles */
@media(max-width:767px) {
  input, .button-group button, button.main { font-size:clamp(2.2vh,3vw,2.6vh); height:7.5vh; }
  button.main { height:8.5vh; }
  .buttons {
    width:100%; max-width:100%; grid-template-columns:1fr 1fr; gap:1vw; margin:2vh 0 0 0; padding:0 3vw;
  }
  .form-container { width:100%; padding:0 3vw; }
}
</style>
</head>
<body>
<h2>IGCSE Past Paper Finder</h2>
<div class="wrapper">
  <div class="form-container">
    <div class="field">
      <label>Subject:</label>
      <div class="button-group" id="subjectButtons"></div>
    </div>
    <div class="field-row">
      <div class="field">
        <label for="year">Year:</label>
        <input type="text" id="year" pattern="\\d{2}|\\d{4}" title="Enter 2 or 4 digits" autocomplete="off">
      </div>
      <div class="field">
        <label for="paper">Paper/Variant:</label>
        <input type="text" id="paper" pattern="\\d{2}" title="Enter 2 digits" autocomplete="off">
      </div>
    </div>
    <div class="field">
      <label>Season:</label>
      <div class="button-group" id="seasonButtons"></div>
    </div>
    <div id="error"></div>
  </div>
  <div class="buttons">
    <div id="qpMsContainer">
      <div id="qpContainer" style="flex:1">
        <button class="main" id="qpBtn">QP</button>
      </div>
      <button class="main" id="msBtn" style="flex:1">MS</button>
    </div>
    <button class="main" id="erBtn">ER</button>
    <button class="main" id="gtBtn">GT</button>
  </div>
</div>
<script>
// Options
const subjects = ['Math','English','Physics','Chemistry','Biology','Economics','ICT','French'];
const seasons = ['Feb/Mar','May/Jun','Oct/Nov'];
// Create button groups
function createButtonGroup(containerId, options) {
  const container = document.getElementById(containerId);
  options.forEach(opt => {
    const btn = document.createElement('button');
    btn.textContent = opt;
    btn.addEventListener('click', () => {
      container.querySelectorAll('button').forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
      updateQPButtons();
      updateOtherButtons();
    });
    container.appendChild(btn);
  });
}
createButtonGroup('subjectButtons', subjects);
createButtonGroup('seasonButtons', seasons);
// Helper: get codes
function getCodes() {
  const subjectBtn = document.querySelector('#subjectButtons button.selected');
  const yearInput = document.getElementById('year').value.trim();
  const paperInput = document.getElementById('paper').value.trim();
  const seasonBtn = document.querySelector('#seasonButtons button.selected');
  if(!subjectBtn || !yearInput || !seasonBtn) return null;
  const subjectMap = {
    "Math":"0607","English":"0500","Physics":"0625","Chemistry":"0620",
    "Biology":"0610","Economics":"0455","ICT":"0417","French":"0520"
  };
  const seasonMap = { "Feb/Mar":"m","May/Jun":"s","Oct/Nov":"w" };
  let year = yearInput;
  if(year.length === 4 && year.startsWith('20')) year = year.substring(2); // 2018 -> 18
  return {
    subjCode: subjectMap[subjectBtn.textContent],
    seasonCode: seasonMap[seasonBtn.textContent],
    year,
    paper: paperInput,
    subject: subjectBtn.textContent,
    fullYear: yearInput
  };
}
// Show error
function showError(msg) {
  document.getElementById('error').textContent = msg;
}
// Update QP + MS (handles IN / Audio alt button, and the French TN special case)
function updateQPButtons() {
  const codes = getCodes();
  const qpMsContainer = document.getElementById('qpMsContainer');
  // 1) French Paper 03 -> single full-width TN button
  if (codes && codes.subject === 'French' && codes.paper === '03') {
    qpMsContainer.innerHTML = '<button class="main" id="tnBtn" style="flex:1; width:100%">TN</button>';
    const tnBtn = document.getElementById('tnBtn');
    tnBtn.onclick = () => {
      const c = getCodes();
      if(!c) { showError("Fill all fields for TN."); return; }
      if(c.paper === '') { showError("Enter paper/variant for TN."); return; }
      showError('');
      const url = `https://pastpapers.papacambridge.com/directories/CAIE/CAIE-pastpapers/upload/${c.subjCode}_${c.seasonCode}${c.year}_tn_${c.paper}.pdf`;
      window.open(url, '_blank');
    };
    return;
  }
  
  // 2) Check for alternate (IN / Audio) first
  let altType = null, altExt = 'pdf', altLabel = '';
  if (codes && codes.paper !== '') {
    if (codes.subject === 'English') {
      altType = 'in'; altLabel = 'IN';
    } else if (codes.subject === 'French' && codes.paper.startsWith('1')) {
      // decide sf vs su using the two-digit year (18 means 2018)
      const y = parseInt(codes.year, 10);
      altType = (y >= 18) ? 'sf' : 'su';
      altLabel = 'Audio';
      altExt = 'mp3';
    }
  }
  
  if (altType) {
    // 3 buttons: QP, alt (IN/Audio), MS - all equal width
    qpMsContainer.innerHTML = `
      <button class="main" id="qpBtn" style="flex:1">QP</button>
      <button class="main" id="altBtn" style="flex:1">${altLabel}</button>
      <button class="main" id="msBtn" style="flex:1">MS</button>
    `;
    const qpBtn = document.getElementById('qpBtn');
    const altBtn = document.getElementById('altBtn');
    const msBtn = document.getElementById('msBtn');
    
    qpBtn.onclick = () => {
      const c = getCodes();
      if(!c) { showError("Fill all fields for QP."); return; }
      if(c.paper === '') { showError("Enter paper/variant for QP."); return; }
      showError('');
      const url = `https://pastpapers.papacambridge.com/directories/CAIE/CAIE-pastpapers/upload/${c.subjCode}_${c.seasonCode}${c.year}_qp_${c.paper}.pdf`;
      window.open(url, '_blank');
    };
    altBtn.onclick = () => {
      const c = getCodes();
      if(!c) { showError("Fill all fields for file."); return; }
      if(c.paper === '') { showError("Enter paper/variant for file."); return; }
      showError('');
      const url = `https://pastpapers.papacambridge.com/directories/CAIE/CAIE-pastpapers/upload/${c.subjCode}_${c.seasonCode}${c.year}_${altType}_${c.paper}.${altExt}`;
      window.open(url, '_blank');
    };
    msBtn.onclick = () => {
      const c = getCodes();
      if(!c) { showError("Fill all fields for MS."); return; }
      if(c.paper === '') { showError("Enter paper/variant for MS."); return; }
      showError('');
      const url = `https://pastpapers.papacambridge.com/directories/CAIE/CAIE-pastpapers/upload/${c.subjCode}_${c.seasonCode}${c.year}_ms_${c.paper}.pdf`;
      window.open(url, '_blank');
    };
  } else {
    // 2 buttons: QP and MS - equal width
    qpMsContainer.innerHTML = `
      <button class="main" id="qpBtn" style="flex:1">QP</button>
      <button class="main" id="msBtn" style="flex:1">MS</button>
    `;
    const qpBtn = document.getElementById('qpBtn');
    const msBtn = document.getElementById('msBtn');
    
    qpBtn.onclick = () => {
      const c = getCodes();
      if(!c) { showError("Fill all fields for QP."); return; }
      if(c.paper === '') { showError("Enter paper/variant for QP."); return; }
      showError('');
      const url = `https://pastpapers.papacambridge.com/directories/CAIE/CAIE-pastpapers/upload/${c.subjCode}_${c.seasonCode}${c.year}_qp_${c.paper}.pdf`;
      window.open(url, '_blank');
    };
    msBtn.onclick = () => {
      const c = getCodes();
      if(!c) { showError("Fill all fields for MS."); return; }
      if(c.paper === '') { showError("Enter paper/variant for MS."); return; }
      showError('');
      const url = `https://pastpapers.papacambridge.com/directories/CAIE/CAIE-pastpapers/upload/${c.subjCode}_${c.seasonCode}${c.year}_ms_${c.paper}.pdf`;
      window.open(url, '_blank');
    };
  }
}
// Update ER and GT (always available)
function updateOtherButtons() {
  const erBtn = document.getElementById('erBtn');
  const gtBtn = document.getElementById('gtBtn');
  erBtn.onclick = () => {
    const c = getCodes();
    if(!c) { showError("Fill all fields for ER."); return; }
    showError('');
    const url = `https://pastpapers.papacambridge.com/directories/CAIE/CAIE-pastpapers/upload/${c.subjCode}_${c.seasonCode}${c.year}_er.pdf`;
    window.open(url, '_blank');
  };
  gtBtn.onclick = () => {
    const c = getCodes();
    if(!c) { showError("Fill all fields for GT."); return; }
    showError('');
    const url = `https://pastpapers.papacambridge.com/directories/CAIE/CAIE-pastpapers/upload/${c.subjCode}_${c.seasonCode}${c.year}_gt.pdf`;
    window.open(url, '_blank');
  };
}
// Event listeners to react to input changes
['year','paper'].forEach(id => document.getElementById(id).addEventListener('input', ()=>{ updateQPButtons(); updateOtherButtons(); }));
['subjectButtons','seasonButtons'].forEach(id => document.getElementById(id).addEventListener('click', ()=>{ updateQPButtons(); updateOtherButtons(); }));
// Initialize
updateQPButtons();
updateOtherButtons();
</script>
</body>
</html>
